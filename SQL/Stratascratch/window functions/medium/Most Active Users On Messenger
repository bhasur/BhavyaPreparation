Q: https://platform.stratascratch.com/coding/10295-most-active-users-on-messenger?tabname=question


Sol:

with t as (
SELECT user1 as user, msg_count from fb_messages
UNION ALL
SELECT user2 as user, msg_count from fb_messages
)

Select user, sum(msg_count) as total_msg_count
from t
group by user
order by total_msg_count desc
limit 10;
