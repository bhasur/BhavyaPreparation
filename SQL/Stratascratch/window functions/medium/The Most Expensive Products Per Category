Q: https://platform.stratascratch.com/coding/9607-the-most-expensive-products-per-category?tabname=question


Sol:

with 
products_rank as
(select 
product_name, 
product_category, 
cast(replace(price, '$', '') as float) as new_price, 
rank() over(partition by product_category order by cast(replace(price, '$', '') as float) desc ) as r
from innerwear_amazon_com )

select * from products_rank group by product_category
