Q: https://platform.stratascratch.com/coding/10351-activity-rank?code_type=3

Sol:

select 
from_user, 
count(id) as total_emails, 
ROW_NUMBER() OVER(ORDER BY count(id) DESC, from_user)  as rownumber
from google_gmail_emails 
gROUP BY from_user 
ORDER BY total_emails DESC, from_user
